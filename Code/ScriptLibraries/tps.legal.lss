'++LotusScript Development Environment:2:5:(Options):0:74
Option Public
Option Declare

Use "fbyte"
Use "tps.legal.claims"
Use "tps.legal.archive"


'++LotusScript Development Environment:2:5:(Forward):0:1
Declare Public Class TPS_LegalService As FBase_Abstract_Service

'++LotusScript Development Environment:2:5:(Declarations):0:10

Public Class TPS_LegalService As FBase_Abstract_Service
	Private m_claims As Variant
	Private m_archive As Variant
	'---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
	'	PUBLIC:
	'---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
	Sub New(in_ps As Variant)
	End Sub
	'---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
	Function getObject( in_link As Variant ) As Variant
		On Error GoTo error_point
		
		Set getObject = Nothing
		If ( in_link.domain Like "tps.legal.claims.*" ) Then
			Set getObject = Me.claims.getObject( in_link )
		ElseIf ( in_link.domain Like "tps.legal.archive.*" ) Then
			Set getObject = Me.archive.getObject( in_link )	
		Else
			Error 1001, "The package for object '" & in_link.domain & "' from parameter 'in_link.domain' is not registered"
		End If
		Exit Function
		
error_point:
		Error Err, TypeName( Me ) & "." & GetThreadInfo(1) & " ( nm: " & Err & ", ln: " & Erl & " ) >> " & Error$
	End Function
	'---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
	Property Get claims As Variant
		On Error GoTo error_point
		
		If IsEmpty( m_claims )Then
			Set m_claims = New TPS_Legal_ClaimsService( Me.Me_Variant )
		End If
		Set claims = m_claims
		Exit Property
		
error_point:
		On Error GoTo 0
		Error Err, TypeName( Me ) & "." & GetThreadInfo(1) & " ( nm: " & Err & ", ln: " & Erl & " ) >> " & Error$
	End Property
	'---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
	Property Get archive As Variant
		On Error GoTo error_point
		
		If IsEmpty( m_archive )Then
			Set m_archive = New TPS_Legal_ArchiveService( Me.Me_Variant )
		End If
		Set archive = m_archive
		Exit Property
		
error_point:
		On Error GoTo 0
		Error Err, TypeName( Me ) & "." & GetThreadInfo(1) & " ( nm: " & Err & ", ln: " & Erl & " ) >> " & Error$
	End Property
	
End Class